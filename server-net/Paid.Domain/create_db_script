CREATE TABLE project (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    created_date timestamp without time zone NOT NULL DEFAULT (now()),
    name character varying(255) NOT NULL,
    description character varying(255) NULL,
    is_active boolean NOT NULL DEFAULT (true),
    logically_deleted_date timestamp without time zone NULL,
    "rateCents" integer NULL,
    address_line1 character varying(255) NULL,
    "address line2" character varying(255) NULL,
    city character varying(255) NULL,
    province character varying(255) NULL,
    postal_code character varying(255) NULL,
    country character varying(255) NULL,
    CONSTRAINT "PK_project" PRIMARY KEY (id)
);


CREATE TABLE invoice (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    project_id integer NOT NULL,
    is_paid boolean NOT NULL,
    created_date timestamp without time zone NOT NULL DEFAULT (now()),
    invoice_date timestamp without time zone NOT NULL,
    due_date timestamp without time zone NOT NULL,
    period_start_date timestamp without time zone NOT NULL,
    period_end_date timestamp without time zone NOT NULL,
    logically_deleted_date timestamp without time zone NULL,
    CONSTRAINT "PK_invoice" PRIMARY KEY (id),
    CONSTRAINT invoice_project FOREIGN KEY (project_id) REFERENCES project (id) ON DELETE RESTRICT
);


CREATE TABLE work_item (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    created_date timestamp without time zone NOT NULL DEFAULT (now()),
    invoice_id integer NOT NULL,
    duration_mins integer NOT NULL,
    description character varying(255) NULL,
    CONSTRAINT "PK_work_item" PRIMARY KEY (id),
    CONSTRAINT invoice_work_item FOREIGN KEY (invoice_id) REFERENCES invoice (id) ON DELETE CASCADE
);


CREATE INDEX "IX_invoice_project_id" ON invoice (project_id);


CREATE INDEX "IX_work_item_invoice_id" ON work_item (invoice_id);


